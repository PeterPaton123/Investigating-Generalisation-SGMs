import numpy as np
from pdf_utils import pdf_normal
import matplotlib.pyplot as plt

x = np.array([4.9087710,4 , 5.33680201, 5.57369232 , 7.36827421 , 4.76830053 , 3.09543514,
  5.6571641 ,  3.05661273,  6.14484692,  3.93854833, -5.68676186, -5.2514677
, -6.05444193, -5.14253569, -5.80272961, -5.04251432, -5.08264828, -4.72898912,
 -5.42740631, -5.63763189,  3.74541378,  5.4030714 ,  4.88287354,  3.16143918,
  5.71034622,  6.51149607,  4.57543516,  3.06154323,  4.04409552,  7.48707008,
 -4.13352585, -4.56070185, -5.23320198, -4.54764366, -3.79943848, -5.53886032,
 -5.6003952 , -5.81522655, -5.52333498, -3.27838302,  4.54090071,  5.55369949,
  4.44313526,  6.10682487,  4.40038538,  6.0519681 ,  4.18802357,  4.08839607,
  4.64851713,  3.9307723 , -5.62749815, -5.11181974, -5.16198492, -4.5907588
, -4.46495771, -5.4346323 , -5.63385868, -4.45407152, -4.19207907, -3.94939852,
 -5.16821003, -7.12728167, -4.44293594, -3.7612226 , -7.14986801, -7.43745279,
 -4.2109623 , -4.17782211, -5.61225605, -4.45267773,  6.33503819,  6.00653791,
  2.89443111,  5.49261284,  5.54656267,  4.87034369,  4.67494774,  3.84079385,
  7.33751392,  4.95445919,  3.92640972,  4.7144208 ,  2.90009022,  5.95015001,
  4.97249937,  5.59705353,  5.55597067,  5.37042046,  3.74777412,  2.92786431,
  5.81211042,  5.99901962,  2.37315273,  5.24407768,  4.98052311,  2.60930777,
  4.47209215,  5.51358795,  5.53961468,  5.60187912,  5.42710686,  6.38568926,
  5.38851643,  5.05028248,  5.31174231,  5.37188148,  4.75043488,  5.4765048
,  4.32909679,  5.90917635,  3.18373442,  6.18211174,  5.58265209,  4.03889847,
  5.16327429,  5.43569565,  5.41124344,  3.1215055 ,  7.09314442,  5.05364275,
  5.33280277,  4.97079706,  4.01079512,  4.60762596,  5.29645586,  5.36332607,
  4.10043478,  5.7136302 ,  4.26289511,  4.35550451, -5.4718833 , -5.29011345,
 -7.35069323, -5.11514664, -5.84891176, -4.01351976, -4.48476505, -5.330863
 ,-6.92046213, -4.4681263 ,  5.11684608,  6.01384497,  4.9387207 ,  3.1461916
,  4.30901337,  4.15651655,  4.43410635,  6.89800167,  5.5977087 ,  5.18306541,
 -5.02920723, -6.48023367, -4.50889111, -5.25002384, -5.26968384, -5.59411097,
 -6.091784  , -3.82484293, -5.3234992 , -5.86986113,  5.14149618,  4.2996397
,  4.79251766,  5.11237001,  6.17375278,  4.06467199,  3.91946578,  5.20673656,
  4.78516769,  5.1680584 , -5.80860949, -5.02640963, -4.62352467, -2.89223337,
 -5.60124063, -6.68424225, -5.04066324, -4.97562885, -6.5946722 , -3.7859869
,  5.3955574 ,  6.07928801,  5.35551596,  5.25384235,  5.58062887,  5.17602825,
  5.3574872 ,  4.19499826,  4.38861656,  3.74887347,  4.85611343,  5.1303792
,  3.22091985,  3.84162021,  5.33550024,  4.81837463,  5.09709597,  7.56802082,
  4.4534421 ,  4.12935352,  5.65889597,  5.83385563,  6.13432217,  6.30188179,
  6.23361206,  3.59413195,  4.47830057,  4.00533056,  4.73467827,  5.1777544
, -5.70514584, -4.49608803, -5.19399834, -4.87056112, -4.43648815, -5.03802776,
 -4.99388742, -5.95939398, -4.35311604, -3.95421433, -5.68506956, -6.67142868,
 -6.71466064, -4.81691408, -5.97487545, -4.79444599, -3.70395041, -5.55444241,
 -3.47876668, -4.77130032, -5.75032568, -4.50045586, -5.16693211, -4.39544201,
 -6.23941612, -5.19222593, -4.42350912, -3.33807492, -4.89773893, -3.82589149,
  4.98721313,  4.58953094,  4.99840784,  6.15733576,  3.49740052,  3.82170439,
  6.34967566,  5.84539747,  6.12853241,  3.67865968, -4.67155266, -6.02067232,
 -5.05360651, -3.85058546, -4.74001122, -6.18981981, -5.36985493, -5.72135067,
 -5.44926882, -5.9466095 ,  6.38975525,  4.22091866,  5.99661875,  4.76285744,
  6.3052721 ,  4.65105867,  4.85340977,  3.18347001,  5.66288662,  3.54660225,
  5.05634594,  6.08541298,  4.89498711,  8.49678612,  4.82622957,  5.7500248
,  5.25293112,  7.16570187,  4.81707764,  5.99609375,  3.98152971,  5.94483709,
  5.2525568 ,  5.65088224,  3.05687284,  4.13576746,  5.44057035,  4.85826683,
  3.23433757,  4.49453783, -5.32411766, -5.64486551, -6.07221031, -4.85942507,
 -3.62741947, -4.08563137, -5.49722862, -4.59700441, -5.06210089, -6.65039062,
 -5.71337795, -7.47339153, -5.28344965, -5.06825447, -4.29668617, -4.93213034,
 -4.01721001, -5.40471554, -6.47608852, -3.89211249,  3.73341465,  4.66222334,
  4.67719698,  4.49751568,  7.25866508,  5.94015837,  5.22009468,  4.49323082,
  5.2588954 ,  4.77628994,  6.71180868,  4.30861425,  4.80631208,  3.8935473
,  4.18315411,  3.80339599,  6.4375248 ,  4.29437304,  5.54919147,  4.66718674,
 -5.23172522, -4.09755564, -4.32567883, -3.91662002, -8.25264263, -5.64202547,
 -4.59143972, -5.75850725, -5.88130522, -5.70144367, -5.2310276 , -4.41986561,
 -4.94634819, -4.10589504, -4.61170959, -6.26841259, -4.98186588, -5.77451801,
 -4.29615355, -4.81947422,  3.07047057,  4.89395046,  7.01604271,  4.61951971,
  4.91667652,  3.01518416,  5.3174057 ,  3.92602015,  5.73186111,  3.8351953
, -5.09679556, -6.04149914, -3.92943931, -3.42894006, -4.95726347, -5.63467312,
 -7.07189035, -3.62624574, -5.7765522 , -6.99204159, -4.75374937, -5.26866293,
 -4.88391495, -4.94745445, -5.3242321 , -4.26835871, -4.49277449, -2.70030975,
 -4.50132608, -3.63858414, -4.43258572, -6.74979448, -5.35552263, -3.36162376,
 -6.0665307 , -5.89893246, -5.64756727, -6.90884161, -4.48217201, -5.21572733,
  5.1666894 ,  5.27593422,  5.22021723,  5.96424437,  4.5553298 ,  5.98538971,
  5.40781689,  4.10903454,  5.31075191,  4.41300011, -3.54373074, -5.31501579,
 -2.91990757, -4.85793638, -3.894418  , -4.79854584, -4.19758177, -5.86035538,
 -6.76358747, -5.73595142, -4.50356817, -4.267066  , -4.99874735, -4.40974426,
 -5.68094921, -6.81765795, -3.76582956, -7.52412128, -6.54648972, -4.5613966
, -4.88774395, -3.34584832, -4.34994221, -6.00145149, -6.60041666, -4.15723896,
 -4.85935926, -6.74137449, -6.36210442, -4.86739206, -5.23492146, -5.9865818
, -5.86428165, -5.13151646, -5.63333273, -5.71858501, -4.00346851, -6.54930639,
 -6.35386324, -6.81913757, -5.63664675, -5.81965303, -2.79498625, -5.26969004,
 -5.68907642, -4.70129108, -6.04446316, -2.18024635, -4.04356194, -2.62129927,
  4.02336216,  4.21050882,  7.12210083,  3.91165876,  5.60639381,  4.64928913,
  4.3344965 ,  5.09029007,  6.03343439,  3.931988  ,  6.04214954,  4.29856825,
  4.98684311,  6.44838095,  5.23123455,  3.06753135,  4.65908623,  3.11157417,
  3.97234821,  3.09600735,  4.53461456,  4.3665061 ,  5.74372482,  5.18052149,
  4.49194574,  5.63396645,  4.04906845,  6.37275934,  5.21162367,  6.8784852
, -5.65681362, -5.34970236, -3.75368929, -8.23483276, -4.01628017, -4.01299238,
 -5.14101076, -6.6661787 , -5.45147562, -4.69270086,  5.0880084 ,  5.36849642,
  1.63182902,  5.80257368,  4.84095335,  3.82728791,  5.0296731 ,  3.83716941,
  5.72477436,  4.2785902 ,  5.17114687,  4.26486588,  4.09872675,  3.77224708,
  4.37962246,  6.13209152,  4.01451826,  4.43056011,  6.53829002,  6.05740786,
 -2.77291322, -5.16177654, -5.23368454, -6.60940266, -4.53729105, -4.77464962,
 -5.97131538, -4.75802326, -5.10514545, -4.28207541,  7.06171989,  5.22011995,
  4.47170973,  4.96535683,  3.89435196,  5.5343051 ,  3.47587633,  2.46888518,
  4.97381783,  5.04630899, -7.39090395, -5.49974298, -6.81820393, -6.09865189,
 -4.06622696, -2.77586961, -4.17215824, -4.0022049 , -4.12035799, -3.14828014,
 -5.66447306, -4.57802868, -3.34035206, -6.99767542, -5.03707504, -4.88053989,
 -5.69389391, -6.7660284 , -4.71988344, -4.44611454, -5.50517559, -5.09071589,
 -6.56421852, -5.86754036, -3.42375469, -2.23658991, -6.09601593, -4.15159607,
 -4.96668148, -6.39504814,  5.74476433,  6.57103348,  4.8800745 ,  4.49732256,
  5.07406187,  4.86316729,  3.6805985 ,  5.10638475,  5.49531698,  6.60798454,
 -4.77440643, -5.60584974, -4.4217968 , -5.68667889, -6.4521904 , -5.30847359,
 -4.75073671, -5.07188225, -5.62496662, -5.49403572, -4.26568174, -5.48379755,
 -4.96411705, -4.10942173, -3.93549943, -5.08233166, -5.92560291, -6.78584528,
 -4.12614918, -5.50676537, -4.17259884, -4.82232332, -1.97719145, -5.52613735,
 -4.37999487, -4.75528288, -5.17880392, -4.33553267, -6.0287323 , -5.69501877,
  4.09310246,  4.9773016 ,  6.85516119,  5.60512257,  5.13601923,  5.9835639
,  4.88221788,  5.8466773 ,  7.59190845,  5.35481071,  4.45362663,  6.08378649,
  4.44186115,  1.74066019,  3.85250545,  6.28194237,  5.85337305,  5.22919035,
  7.54652452,  4.58093405,  4.37371445,  5.32487583,  5.57760191,  6.55489254,
  7.45367336,  5.82891893,  3.65987706,  5.26480627,  5.99354887,  5.7105298
,  5.1298933 ,  3.89118791,  3.04236698,  4.04219437,  5.99870872,  6.99807787,
  6.32946682,  4.05100155,  4.39805841,  4.24877691,  5.88805056,  3.40726161,
  3.21152091,  4.79961634,  3.94265151,  6.13869286,  5.31449032,  6.00789928,
  6.1113987 ,  4.46550417, -6.25948954, -4.71327353, -4.39092255, -4.20762777,
 -3.61859107, -5.63576889, -6.55177879, -6.54166317, -6.95079756, -6.60894108,
 -3.99728107, -5.63347006, -5.72257996, -5.22810888, -6.09325361, -5.7938652
, -4.62565517, -4.45561695, -4.85428667, -5.17916107,  4.54598618,  4.15543556,
  6.05997133,  5.71987295,  5.23353481,  6.76467609,  4.20846367,  5.68736362,
  6.84386921,  4.91469622, -6.61143494, -4.75682497, -5.01125813, -6.31892347,
 -5.84735155, -4.23222637, -6.27827501, -4.26665068, -6.09829187, -3.76357818,
 -4.5442071 , -6.12405062, -4.06455421, -3.80171466, -6.05879593, -4.75990486,
 -4.27425766, -5.08340216, -7.50776672, -4.42591429,  5.33454609,  4.81849337,
  6.09866858,  3.89409995,  4.74473429,  5.00529051,  5.90686989,  5.4242878
,  5.81551027,  5.20260191, -4.05303288, -5.22046518, -5.65403366, -5.81278133,
 -4.77239943, -4.97708607, -5.37674618, -6.23196411, -5.314291  , -4.75924587,
 -3.50495052, -2.5353241 , -5.81691551, -5.40929604, -5.30842829, -4.79237843,
 -3.94429994, -5.00015259, -2.55685163, -3.80221963,  4.95615816,  6.61304283,
  3.85188627,  5.98832273,  3.04927301,  5.70559263,  3.76854587,  4.31640863,
  5.53163242,  5.86006021,  5.3119359 ,  6.89560986,  6.63485336,  6.00170851,
  3.92880034,  5.32869053,  5.11475086,  3.2623229 ,  4.43041039,  6.08833885,
  4.15086269,  4.11131096,  5.54295158,  5.12688446,  5.48628712,  2.62928247,
  6.0349102 ,  6.86114693,  5.40946722,  4.03087139,  5.10561371,  5.04717112,
  5.96272469,  6.36265326,  5.84114122,  5.03341055,  5.76216745,  5.59733105,
  5.50384188,  5.49555779,  6.60066652,  4.9427743 ,  5.06240368,  5.12297201,
  6.59129524,  3.94777226,  4.60198593,  6.01896763,  3.4726367 ,  4.48766661,
 -3.35383034, -4.51216984, -4.30518436, -4.99585247, -5.22442579, -5.09678888,
 -5.41271305, -5.09486437, -4.55912495, -5.82756376,  6.07356215,  3.73339701,
  5.01553822,  6.1155262 ,  5.26896381,  5.32553005,  4.59346294,  5.82036734,
  5.38130951,  6.30826759, -3.8052721 , -4.81252003, -3.81225395, -6.14297009,
 -5.4155426 , -5.27879906, -4.81173325, -4.7420516 , -6.51466131, -4.30198193,
 -3.39045382, -4.64959717, -3.92734647, -6.50477076, -7.68435192, -5.75949526,
 -5.90640259, -5.63182878, -4.64409637, -4.7007246 ,  3.40950346,  6.0758481
,  5.36717081,  4.08827972,  5.7354002 ,  6.11094809,  5.18581963,  4.39790821,
  4.26653719,  6.26382017,  5.26466179,  6.2300725 ,  6.04396772,  6.44766808,
  5.12299681,  5.29518414,  3.08067465,  5.82658863,  5.16308928,  7.92027521,
 -5.05651712, -5.87408495, -5.9868207 , -4.8496213 , -4.44818735, -4.88537931,
 -5.5006175 , -6.12632418, -5.4480691 , -3.86540985, -5.5387764 , -4.2247963
, -5.23110771, -5.27288389, -3.04488015, -6.28627014, -6.5544095 , -6.29210997,
 -5.20519876, -5.00885868,  5.74054289,  5.942904  ,  5.32407045,  7.81270409,
  2.81184196,  7.52941322,  6.3250041 ,  5.3936615 ,  5.44181442,  6.3241806
, -4.02737331, -5.10542345, -4.97630692, -4.73548126, -4.86382008, -4.07256842,
 -3.33289433, -4.18592072, -5.94501591, -5.04052877,  6.11887646,  6.58866692,
  3.6462667 ,  5.15713263,  3.96183515,  5.26823521,  3.44850564,  4.00296879,
  4.53097248,  4.95877981,  4.57707071,  6.31496811,  5.01539755,  6.938972
 , 4.30081367,  6.00712252,  3.68896222,  4.47929144,  5.03357697,  3.62489176,
 -4.17461061, -5.88659048, -4.05154848, -3.47999215, -4.48561335, -4.60063648,
 -4.05636215, -5.39235258, -5.2657814 , -5.93977928,  5.26589918,  6.32264376,
  5.11906338,  2.98858595,  6.13340902,  5.00549126,  6.09908915,  4.769629
 , 6.35704565,  4.34811735,  4.56202507,  6.16051483,  4.75706673,  4.67779541,
  4.483253  ,  4.93226385,  4.9490571 ,  5.92712831,  4.18343639,  4.34081554,
  5.74389076,  5.78252602,  5.42098093,  3.63764286,  5.82879639,  4.35841084,
  2.20704794,  5.95531321,  6.03209257,  6.76348686, -5.19792891, -3.89457107,
 -5.47122622, -4.86960888, -4.17816305, -4.65308285, -5.63790607, -3.64600635,
 -5.6104002 , -4.74339199,  7.09251547,  4.47724485,  5.30321741,  5.16309881,
  3.8399868 ,  5.27931023,  6.55997276,  4.77496147,  3.31959152,  3.83111882,
  3.52779508,  4.45277977,  3.73946214,  6.25058174,  5.60784483,  4.30418396,
  6.67582798,  5.44997931,  4.76255846,  5.55172062,  3.84312296,  5.61844158,
  4.34340429,  4.90981531,  4.42162704,  3.97198033,  3.59363413,  5.60705423,
  7.39780712,  6.42658091,  5.7287097 ,  4.7856245 ,  5.18385601,  4.89813948,
  4.49694252,  2.77180648,  6.30486774,  3.92281389,  3.72603846,  4.89545298,
 -5.1873126 , -5.83456373, -3.84806061, -3.32823753, -5.15186691, -4.57293129,
 -4.05064297, -5.25585318, -7.00010061, -4.72337723,])

plt.hist(x, density=True, bins=50)
## Prior distribution is a mixture of Gaussians:
prior_weight = np.array([0.5, 0.5])
prior_means = np.array([-5., 5.])
prior_variance = np.array([1., 1.])


def expected_pdf(xt):
    total = 0.0
    for i in range(np.size(prior_weight)):
        total += prior_weight[i] * pdf_normal(mean=prior_means[i], var=prior_variance[i], x=xt)
    return total

plt.plot(np.linspace(-10, 10, 1000), expected_pdf(np.linspace(-10, 10, 1000)))

plt.show()
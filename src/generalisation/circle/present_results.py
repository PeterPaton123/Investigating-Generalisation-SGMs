import jax.numpy as jnp
from jax import vmap
import matplotlib.pyplot as plt

from result import Result

def setup():
    n_256_l_3_simple = jnp.array([
        (0.31444796013832094, 0.4407345229977121),
        (0.26667455112934113, 0.2149280581176281),
        (0.24456124810377758, 0.15365521478652955),
        (0.25042992369333905, 0.12693067820866905),
        (0.264026202917099, 0.10850381751855215),
        (0.2880398624340693, 0.09886452627182006),
        (0.29664172971248626, 0.09679328374067941),
        (0.3113867138624191, 0.09075008948644002),
        (0.3207951751947403, 0.08701568877696991),
        (0.3323636467456818, 0.08594477291901906),
        (0.3406585394938787, 0.08018848280111948),
        (0.3471288034121196, 0.08580168187618256),
        (0.3470817738374074, 0.08216932404041291),
        (0.35191471711794536, 0.08244853325684864),
        (0.3550965448220571, 0.0825142145951589),
        (0.35639289255936946, 0.08627741360664368),
        (0.3580177728732427, 0.08462742340564727),
        (0.3630257956981659, 0.08443078537782034),
        (0.36128510268529257, 0.07578455491860708),
        (0.3646281618674596, 0.08052092818419138),
        (0.3667728241284689, 0.07455233641465504),
        (0.3679461593230566, 0.07836562764644622),
        (0.37021657307942707, 0.0826092890103658),
        (0.37198290991783145, 0.0744879609743754),
        (0.36666288030147554, 0.07897891255219777),
        (0.3699211138486862, 0.07602025314172109),
        (0.37086290403207145, 0.0797464550336202),
        (0.3817664191325506, 0.07298177607854207),
        (0.3986380039056142, 0.07237573381265006),
        (0.3781306066115697, 0.07207740743954977)
        ])

    n_256_l_3_metric = jnp.array([
        (0.26902634525299074, 0.22036727983049445),
        (0.1386722704966863, 0.10746404739045246),
        (0.11886212694644928, 0.0768276257249032),
        (0.10449175588289894, 0.06346535743597292),
        (0.12425423272450764, 0.05425192709091449),
        (0.1338663987716039, 0.04943228146754845),
        (0.1357936880985896, 0.04839666020197814),
        (0.1549874002536138, 0.04537506307485843),
        (0.16705362292130788, 0.04350786272012337),
        (0.1823136309782664, 0.04297240451299294),
        (0.20438991240660348, 0.04009425973219816),
        (0.20660101652145385, 0.04290085648817961),
        (0.1926558198928833, 0.04108467518610899),
        (0.19829881087938944, 0.04122427053573871),
        (0.20014937575658165, 0.04125711160225813),
        (0.19845870872338617, 0.04313870991590762),
        (0.20318819344043731, 0.042313713941207975),
        (0.20639187963803612, 0.04221538892709359),
        (0.20632470464706423, 0.03789228092951719),
        (0.20658302374680834, 0.04026046104553485),
        (0.2080310471057892, 0.0372761702470297),
        (0.21785154434045156, 0.03918280978325153),
        (0.2146516840060552, 0.0394894522361273),
        (0.21467941141128538, 0.041304641895722784),
        (0.2472737032572428, 0.03724397879166548),
        (0.21901161523660023, 0.03801012435876473),
        (0.21850399386882785, 0.03987322729153578),
        (0.25924969645341234, 0.03649088670137668),
        (0.28800081737836203, 0.03618786517106637),
        (0.24383224181334176, 0.03603870019637689)
        ])

    n_256_l_3_true = jnp.array([
        (0.2710998670260112, 0.22036728),
        (0.19188731141885124, 0.10746405),
        (0.1490681366523107, 0.07682762),
        (0.14971270706256232, 0.06346536),
        (0.15149924280246096, 0.05425193),
        (0.1725609381198883, 0.04943229),
        (0.18003717192014057, 0.04839667),
        (0.1805912092924118, 0.04537506),
        (0.17568351898590723, 0.04350786),
        (0.18289421335856115, 0.04297241),
        (0.19296790609757103, 0.04009427),
        (0.20991195237636567, 0.04290086),
        (0.1996510409911473, 0.04108468),
        (0.20902789292732873, 0.04122427),
        (0.20909355453650152, 0.04125712),
        (0.20191068991025285, 0.04313871),
        (0.22234673664967214, 0.04231371),
        (0.21904361353317894, 0.04221539),
        (0.2053760613997777, 0.03789229),
        (0.2241326224803924, 0.04026046),
        (0.22308470906813938, 0.03727617),
        (0.21967611354589459, 0.03918281),
        (0.2220542920827865, 0.03948946),
        (0.23289822345972055, 0.04130465),
        (0.25163660518328346, 0.03724398),
        (0.22918384712934492, 0.03801013),
        (0.23014185533920917, 0.03987323),
        (0.2642144990364711, 0.03649089),
        (0.2945898886521657, 0.03618787),
        (0.24943058747053143, 0.0360387)
        ])


    n_16_l_3_simple = jnp.array([
        (0.24757553160190585, 0.6562519162334501),
        (0.22642987410227455, 0.5703573437705636),
        (0.23007306516170503, 0.5220110571533441),
        (0.23515746732552847, 0.48315880285389723),
        (0.23407496937115987, 0.4474516153633595),
        (0.24321462305386862, 0.41292749097943304),
        (0.23412049730618795, 0.38673818656305475),
        (0.23219400640328725, 0.3582694344818592),
        (0.22341943915685017, 0.33578508151570957),
        (0.22286875224113462, 0.3153426471116642),
        (0.22163414537906648, 0.29666821798185505),
        (0.21885198012987775, 0.28137228722622),
        (0.2201714806954066, 0.2669361889412006),
        (0.2177431672811508, 0.2518618801534176),
        (0.21767048199971517, 0.23603899884720642),
        (0.21787692832946778, 0.2218699938133359),
        (0.2178693689107895, 0.21329278631011644),
        (0.21895354243119558, 0.20173529934013884),
        (0.2208494600057602, 0.19404139787952104),
        (0.2207961736917496, 0.18463384823997814),
        (0.2231541889111201, 0.17760402038693426),
        (0.2247613749106725, 0.17188862453897794),
        (0.22684565869967144, 0.16455389228463174),
        (0.22540199363231658, 0.1588846815675497),
        (0.23098322268327076, 0.15457803841431933),
        (0.23419720999399823, 0.15170773194233578),
        (0.23611218730608624, 0.1485214716444413),
        (0.2334965580304464, 0.1448708102951447),
        (0.23617040908336642, 0.14114644181728364),
        (0.23623025139172873, 0.13823599044481916)
        ])

    n_16_l_3_metric = jnp.array([
        (0.15759898912906645, 0.3281259764483635),
        (0.17032116683324178, 0.2851786902169202),
        (0.19613684912522633, 0.26100554690831046),
        (0.20656861984729766, 0.24157941975858702),
        (0.20418242971102396, 0.22372582601331814),
        (0.22675249401728312, 0.20646376382135495),
        (0.21454106012980145, 0.19336911161316578),
        (0.20815870575110118, 0.17913473557256804),
        (0.18774597756067912, 0.1678925590894932),
        (0.17897262708346048, 0.15767134188747053),
        (0.1695568705002467, 0.14833412732256596),
        (0.15722794969876608, 0.14068616194474842),
        (0.14616873610019682, 0.1334681128022387),
        (0.13860810577869415, 0.12593095840834723),
        (0.13375516319274902, 0.11801951775524164),
        (0.13285662213961283, 0.11093501523830636),
        (0.12222558136781053, 0.10664641148669664),
        (0.1180089409748713, 0.10086766800170784),
        (0.1232966624498367, 0.09702071727139894),
        (0.11856084104379015, 0.0923169424516275),
        (0.1215951324701309, 0.08880202852510556),
        (0.1329877543846766, 0.08594433060112738),
        (0.1374033516248067, 0.08227696447395429),
        (0.15427218107382454, 0.07944235911541328),
        (0.17009877765178677, 0.07728903753879811),
        (0.17449243752161658, 0.0758538843028063),
        (0.1769310249487559, 0.07426075415385906),
        (0.16781343070665994, 0.07243542347921078),
        (0.17129815646012622, 0.07057323924028024),
        (0.1741194446881612, 0.06911801355404798)
    ])

    n_16_l_3_true = jnp.array([
        (0.1734787601232529, 0.32812595),
        (0.12318200898170473, 0.2851787),
        (0.13079426215092338, 0.26100552),
        (0.14342539294560752, 0.24157943),
        (0.1431035580833753, 0.22372583),
        (0.16881747929255167, 0.20646377),
        (0.15426633961995442, 0.19336909),
        (0.15008296644687655, 0.17913474),
        (0.12767229413986206, 0.16789256),
        (0.1209245452086131, 0.15767135),
        (0.11246729934215546, 0.14833413),
        (0.09811938595771791, 0.14068617),
        (0.1001793992916743, 0.13346812),
        (0.08887624688943227, 0.12593096),
        (0.08332508659362792, 0.11801952),
        (0.0818803347746531, 0.11093502),
        (0.08027825597922007, 0.10664641),
        (0.08369123287995656, 0.10086767),
        (0.09009671235084535, 0.09702072),
        (0.08406140434741972, 0.09231695),
        (0.09207526856660843, 0.08880202),
        (0.09235435666640598, 0.08594433),
        (0.09355926324923833, 0.08227697),
        (0.08493409955501555, 0.07944236),
        (0.1068583758274714, 0.07728904),
        (0.10949963510036466, 0.07585388),
        (0.11130012957255045, 0.07426076),
        (0.09983541512489316, 0.07243543),
        (0.10450263200203576, 0.07057324),
        (0.10352976800998051, 0.06911802)
    ])


    n_64_l_3_simple = jnp.array([
       (0.24507565800348918, 0.44772651627411447),
        (0.24510498785972595, 0.286250356828173),
        (0.2339619076649348, 0.19713564467678468),
        (0.23980758508046468, 0.15937089850505193),
        (0.2408920295238495, 0.1427157366176446),
        (0.2521893942753474, 0.12770434741179149),
        (0.2615435170729955, 0.12055263779560724),
        (0.2709689150651296, 0.11620450794696807),
        (0.2794095978339513, 0.11122112850348154),
        (0.2916011314789454, 0.10687752095858255),
        (0.30132161025206244, 0.09997213892141978),
        (0.3102573083241781, 0.09742218748728435),
        (0.3187298112312953, 0.09240044271945953),
        (0.32444357113043465, 0.08997910559177398),
        (0.32491546078523004, 0.08548601325352986),
        (0.32952984285354614, 0.08444647312164308),
        (0.33487443745136264, 0.08412448624769847),
        (0.3414706084728241, 0.08161993892987568),
        (0.3429370837211609, 0.08372193920612335),
        (0.345379122932752, 0.08057511488596598),
        (0.34693283538023634, 0.08015945879618326),
        (0.3486697479089101, 0.0811451312303543),
        (0.3527141964038213, 0.07784867350260416),
        (0.3525102665424348, 0.07196301805973054),
        (0.3528836565812429, 0.07266708978017172),
        (0.35362300797303514, 0.07078571283817292),
        (0.3562154124975204, 0.07110081624984742),
        (0.35592694715658824, 0.07012083951632181),
        (0.35754819738864896, 0.06701137840747834),
        (0.35759854145844777, 0.0711232103506724)
    ])

    n_64_l_3_metric = jnp.array([
        (0.1294688002268473, 0.22386327646869564),
        (0.10959492723147074, 0.1431251967457249),
        (0.09629184464613595, 0.09856784067003076),
        (0.10471911899248759, 0.0796854675841644),
        (0.12066772611935933, 0.07135788664046074),
        (0.14829239261150357, 0.06385219203753416),
        (0.1612666248877843, 0.06027633722944204),
        (0.16444335937500001, 0.05810227230512246),
        (0.17987467221419018, 0.055610582583379184),
        (0.20620964411894477, 0.053438778810929705),
        (0.22273298688729604, 0.04998608779234831),
        (0.23858593201637265, 0.048711112075280595),
        (0.25499499412377674, 0.04620023969136819),
        (0.25399934526284534, 0.04498957112752541),
        (0.23985288067658742, 0.04274302495840336),
        (0.24196149420738222, 0.042223254892459955),
        (0.23433496518929797, 0.04206226145548765),
        (0.26324882912635805, 0.04080998779657627),
        (0.2579348871707916, 0.0418609879347001),
        (0.2559243407646815, 0.040287575774621415),
        (0.2531547333796819, 0.040079747491311477),
        (0.24567133394877114, 0.040572582118939805),
        (0.2593779467344284, 0.03892435301664615),
        (0.25215631310145065, 0.03598152660651152),
        (0.2594914028644562, 0.03633356314225142),
        (0.2541193373600642, 0.035392872724166954),
        (0.26498574268817904, 0.035550423198174884),
        (0.2537255204121272, 0.03506043363931918),
        (0.26060679336388903, 0.033505707535377585),
        (0.2478760331074397, 0.03556161516232435)
    ])

    n_64_l_3_true = jnp.array([
        (0.16866719992955526, 0.22386327),
        (0.17403414098421732, 0.1431252),
        (0.12750129437446595, 0.09856785),
        (0.11035000799099605, 0.07968547),
        (0.09466383876403171, 0.07135789),
        (0.1051576537688573, 0.06385219),
        (0.12057742273807524, 0.06027634),
        (0.12661245012283323, 0.05810227),
        (0.1397935173114141, 0.05561059),
        (0.16562785772482552, 0.05343878),
        (0.18382377080122628, 0.04998609),
        (0.19999632255236305, 0.04871111),
        (0.22100264183680216, 0.04620024),
        (0.22240517318248748, 0.04498957),
        (0.20190105640888212, 0.04274303),
        (0.20620771058400467, 0.04222326),
        (0.20966607765356696, 0.04206226),
        (0.23266817633310952, 0.04080999),
        (0.22620387156804403, 0.04186099),
        (0.23129569582144416, 0.04028758),
        (0.21760810339450834, 0.04007975),
        (0.21388449223836262, 0.04057259),
        (0.23797072708606717, 0.03892436),
        (0.21041167283058163, 0.03598153),
        (0.2300499249299367, 0.03633357),
        (0.22202088844776152, 0.03539288),
        (0.23667741262912748, 0.03555043),
        (0.221014148513476, 0.03506044),
        (0.22265965370337165, 0.03350571),
        (0.2122771545648575, 0.03556162)
    ])

    n_64_l_5_simple = jnp.array([
        (0.24352790562311807, 0.3785846298784018),
        (0.24601680163542433, 0.2111361880029241),
        (0.24599033558368683, 0.16316878258188566),
        (0.2344309682448705, 0.14466406381626923),
        (0.23291024255752563, 0.13170397061109543),
        (0.24180833582083383, 0.11847424395879108),
        (0.2575171397924423, 0.11585673479239145),
        (0.27001278901100156, 0.11646898156404495),
        (0.2868455433448156, 0.12187444545825321),
        (0.30258949458599094, 0.11673916447162629),
        (0.3145094002087911, 0.123716126759847),
        (0.3310198676188787, 0.11329204638799031),
        (0.3353549037774404, 0.10537925453980762),
        (0.3357991681496302, 0.10101814317703248),
        (0.34535636893908184, 0.09087124880154926),
        (0.3462952297528585, 0.09974788937966028),
        (0.34738367184003194, 0.0909875484307607),
        (0.3499763601223628, 0.08588926442464193),
        (0.348393963654836, 0.09567998353640238),
        (0.35095124610265094, 0.08283087078730265),
        (0.35458473447958627, 0.08806919439633687),
        (0.35875615489482876, 0.08399267597993215),
        (0.36046532094478606, 0.09753671658039093),
        (0.36285738730430606, 0.09444980029265085),
        (0.3646347848176956, 0.08978891460100809),
        (0.3660673732757569, 0.09349323928356171),
        (0.3653496684233348, 0.09550872000058493),
        (0.3670173493226369, 0.09162912706534068),
        (0.3629729141791662, 0.0804260317881902),
        (0.3661569950580597, 0.08585239617029826)
    ])

    n_64_l_5_metric = jnp.array([
        (0.17475860357284545, 0.18929233327083927),
        (0.16470879940191901, 0.10556811233310048),
        (0.1624149694840113, 0.08158440962258123),
        (0.15646303403377532, 0.07233205023977304),
        (0.11643951106071469, 0.06585200363718613),
        (0.12353020354111985, 0.05923714031103397),
        (0.12408581578731533, 0.05792838572783415),
        (0.11762506230672198, 0.058234509113660904),
        (0.12165108907222744, 0.060937241060765035),
        (0.13761242624123887, 0.058369599097203656),
        (0.14119087076187134, 0.06185807734055464),
        (0.15144757656256358, 0.05664603842619205),
        (0.16244655410448708, 0.05268964297893787),
        (0.1690871727863947, 0.05050908833069746),
        (0.17560893368721006, 0.04543564269267663),
        (0.17986051750183102, 0.04987395944518988),
        (0.18605225833257036, 0.04549378702365502),
        (0.18188123881816862, 0.04294464470270419),
        (0.1811979179382324, 0.047839995357624135),
        (0.1931496934890747, 0.041415445023011616),
        (0.19532815961043037, 0.04403460591359083),
        (0.20429278679688773, 0.04199634666565204),
        (0.19895732486248016, 0.048768359972269776),
        (0.21001150043805442, 0.04722490059657042),
        (0.20777250746885936, 0.04489445802890405),
        (0.21248755645751954, 0.046746619774134406),
        (0.2053064448833466, 0.047754363033405384),
        (0.20513725113868717, 0.045814563148450296),
        (0.20509633537133537, 0.040213024768463224),
        (0.2102135744094849, 0.042926201754044935)
    ])

    n_64_l_5_true = jnp.array([
        (0.15731157416105274, 0.18929234),
        (0.1655027192036311, 0.10556811),
        (0.16221646296977998, 0.08158442),
        (0.11992324308554334, 0.07233205),
        (0.10195041577021281, 0.065852),
        (0.09642239566644033, 0.05923714),
        (0.12110453756650287, 0.05792838),
        (0.14165168462196986, 0.05823451),
        (0.17008857395251592, 0.06093724),
        (0.18706056759754813, 0.0583696),
        (0.18013039042552312, 0.06185808),
        (0.20767583199342088, 0.05664605),
        (0.1988726442257563, 0.05268965),
        (0.18566846001148218, 0.0505091),
        (0.19304514869054157, 0.04543565),
        (0.18581310288111363, 0.04987396),
        (0.18386947449048358, 0.04549379),
        (0.18841200143098824, 0.04294465),
        (0.19032417730490359, 0.04784),
        (0.1893598618904749, 0.04141545),
        (0.20109532531102495, 0.04403461),
        (0.19594862902164456, 0.04199635),
        (0.20973021890719729, 0.04876837),
        (0.21909049220879873, 0.04722491),
        (0.21952815401554104, 0.04489446),
        (0.22148080905278525, 0.04674662),
        (0.2167167921861013, 0.04775437),
        (0.22013847474257148, 0.04581457),
        (0.207163489262263, 0.04021303),
        (0.22721145838499068, 0.0429262)
    ])

    n_256_l_5_simple = jnp.array([
        (0.304140140414238, 0.47755762458592654),
        (0.36446488436063135, 0.27042774425819516),
        (0.3133176846901575, 0.1752386288717389),
        (0.2890171835422516, 0.13796641298135123),
        (0.2573237322171529, 0.1251050559282303),
        (0.25822964910666146, 0.11841564897696177),
        (0.26307371536890667, 0.12121465019385019),
        (0.2844785347779592, 0.09810777922471363),
        (0.3044929228226344, 0.09285379433631896),
        (0.314383376677831, 0.08662700939178467),
        (0.32892132810751595, 0.08914105081558228),
        (0.3338451571067174, 0.09029871757825217),
        (0.3384832448561986, 0.08635699240366618),
        (0.3399268528223038, 0.07939729571342469),
        (0.3436465596755346, 0.07607916641235352),
        (0.34497726277510327, 0.08228337295850119),
        (0.3409129198392232, 0.10416898381710052),
        (0.3521092854340871, 0.07001517188549042),
        (0.3506663574377696, 0.07698497895399731),
        (0.35824966100851696, 0.08234657804171244),
        (0.3566259322166443, 0.06624472737312317),
        (0.3564700592358907, 0.07606358520189921),
        (0.3638099578221639, 0.08487425128618876),
        (0.3600751917759578, 0.08028599937756856),
        (0.3604715588092804, 0.08875087694327037),
        (0.3604864252010981, 0.08082109606266022),
        (0.3699075760444005, 0.07001883125305175),
        (0.3667846955855688, 0.09310968641440072),
        (0.3912791306177775, 0.10900876347223916),
        (0.39860322399934134, 0.10926154379049938)
    ])

    n_256_l_5_metric = jnp.array([
        (0.19545556430021918, 0.2387788306246017),
        (0.30786027383804315, 0.135213890460736),
        (0.2685994596878687, 0.08761933276750787),
        (0.20941273911794026, 0.06898322482231403),
        (0.18620808021227514, 0.06255254629575356),
        (0.20458733554681138, 0.0592078428201193),
        (0.19152154390017187, 0.06060734342856352),
        (0.1438871172269185, 0.04905390794399524),
        (0.16203252017498015, 0.046426915499797904),
        (0.18383487367630003, 0.04331352302753075),
        (0.19061814924081164, 0.04457053066614414),
        (0.21172261106967924, 0.045149363093804754),
        (0.20421952100594837, 0.043178501460186085),
        (0.19287373491128282, 0.03969866038683201),
        (0.20260539758205415, 0.03803959470314924),
        (0.20202696979045867, 0.04114170481088901),
        (0.202480047861735, 0.05208450141870126),
        (0.1913926609357198, 0.03500760399622862),
        (0.21362112943331402, 0.03849249390088662),
        (0.21405335589249927, 0.04117328657034183),
        (0.21233815701802572, 0.03312237426959618),
        (0.21880325094858805, 0.03803179619037255),
        (0.2290635860761007, 0.042437116357914056),
        (0.2102450192372004, 0.040142992906999034),
        (0.23076247334480282, 0.04437543522639219),
        (0.189269361615181, 0.04041055158101663),
        (0.2227054061492284, 0.03500941448731368),
        (0.20886945911248525, 0.046554834716748636),
        (0.23324652810891466, 0.054504397246471485),
        (0.2695997450749079, 0.05463075346201681)
    ])

    n_256_l_5_true = jnp.array([
        (0.22517803013324736, 0.23877884),
        (0.3148663535118103, 0.13521388),
        (0.2552760966221491, 0.08761933),
        (0.21665632208188373, 0.06898323),
        (0.1645954064329465, 0.06255255),
        (0.1525801441669464, 0.05920785),
        (0.12493126825491585, 0.06060735),
        (0.13919586418072383, 0.04905391),
        (0.1575867169896761, 0.04642692),
        (0.16545653339227037, 0.04331353),
        (0.16621055308977756, 0.04457054),
        (0.17884761989116665, 0.04514937),
        (0.1875468454758326, 0.04317851),
        (0.18573721897602077, 0.03969866),
        (0.184842468937238, 0.0380396),
        (0.20224864614009855, 0.04114171),
        (0.19323615411917366, 0.0520845),
        (0.21282483863830562, 0.03500761),
        (0.19554154076178865, 0.0384925),
        (0.19364630035559327, 0.04117329),
        (0.2015006599426269, 0.03312238),
        (0.2112524914741516, 0.0380318),
        (0.22414444287618002, 0.04243712),
        (0.21408992332220075, 0.04014299),
        (0.22190145532290137, 0.04437544),
        (0.23844131235281626, 0.04041056),
        (0.23920838536818823, 0.03500942),
        (0.23459244879086805, 0.04655484),
        (0.27831261712312694, 0.0545044),
        (0.29194234279791514, 0.05463076)
    ])

    n_16_l_5_simple = jnp.array([
        (0.2177498692671458, 0.5909830548067888),
        (0.21693785627683004, 0.5264602518783261),
        (0.2275139397382736, 0.47695694288859763),
        (0.23088436484336852, 0.4283241108357907),
        (0.25016355089346565, 0.3769105095118285),
        (0.2538407033284505, 0.3356863835602999),
        (0.2625116649866104, 0.30167384242018064),
        (0.2625491843620936, 0.2729127914955219),
        (0.26955023407936096, 0.24172958463430405),
        (0.2674373655319214, 0.22289013756314913),
        (0.2832892508904139, 0.20255158016085625),
        (0.2918168296019236, 0.18611902643367648),
        (0.29035989876588186, 0.17152483432988327),
        (0.3191731534401576, 0.1578894265194734),
        (0.29538768124580383, 0.14563614178697265),
        (0.26125139435132344, 0.1372670686331888),
        (0.26402311225732167, 0.13164371939500172),
        (0.2650329571167628, 0.12487841534614562),
        (0.260832439382871, 0.11360451857248942),
        (0.2650759882926941, 0.11325477975606918),
        (0.2609665313164393, 0.10593043897549312),
        (0.2640338970422745, 0.10250113916397097),
        (0.2660249658425649, 0.10003645515441895),
        (0.27010091237227124, 0.09798142894109091),
        (0.27758693663279216, 0.09626659454902013),
        (0.28074022090435025, 0.09546726675828297),
        (0.28591490030288697, 0.0952530614733696),
        (0.2852117136716843, 0.09285333764553069),
        (0.29695822099844615, 0.0937002287308375),
        (0.29730205432573953, 0.09272655550638834)
    ])

    n_16_l_5_metric = jnp.array([
        (0.10681866717338559, 0.2954915457350328),
        (0.09514991084734595, 0.2632301442708015),
        (0.08335122962792713, 0.23847848977593727),
        (0.08459072275956471, 0.21416207374953375),
        (0.11925296171506247, 0.18845527308755264),
        (0.12352361838022868, 0.16784321011178838),
        (0.1326919850508372, 0.15083693954172875),
        (0.1129183142185211, 0.13645641407939935),
        (0.13952836064497628, 0.12086481064879045),
        (0.13361831617355346, 0.11144508711321299),
        (0.16768653043111165, 0.10127580841206654),
        (0.15787413644790652, 0.09305953154847667),
        (0.16876060382525127, 0.08576243549658005),
        (0.20896700922648112, 0.07894473159137512),
        (0.19649264895915985, 0.07281808922512475),
        (0.14672090125083923, 0.06863355264823282),
        (0.1295148652791977, 0.06582187802913929),
        (0.12201529467105866, 0.06243922600471123),
        (0.14068563584486643, 0.05680227761788313),
        (0.14539140804608663, 0.05662740820967301),
        (0.1611369151671727, 0.052965237819384975),
        (0.17301551043987273, 0.0512505879136239),
        (0.1493760015169779, 0.05001824590884789),
        (0.14580517462889347, 0.04899073280218387),
        (0.14249301560719807, 0.04813331560614849),
        (0.14143518022696172, 0.04773365171077991),
        (0.13727319876352945, 0.04762654906832322),
        (0.14947480595111845, 0.04642668715440377),
        (0.15652371688683828, 0.04685013269705717),
        (0.14325938169161476, 0.04636329608483259)
    ])

    n_16_l_5_true = jnp.array([
        (0.12715327640374502, 0.29549155),
        (0.12610997688770295, 0.26323014),
        (0.14971547478437425, 0.2384785),
        (0.14312173318862914, 0.21416208),
        (0.16737724896272022, 0.18845525),
        (0.16251227752367656, 0.16784322),
        (0.17115656165281934, 0.15083694),
        (0.17934174660841623, 0.13645642),
        (0.16531538756688435, 0.12086481),
        (0.16961095539728804, 0.11144508),
        (0.2122369351784388, 0.10127581),
        (0.221011899014314, 0.09305954),
        (0.22446198664108913, 0.08576243),
        (0.2713859049280485, 0.07894474),
        (0.23800977889696756, 0.07281809),
        (0.16171392597754797, 0.06863356),
        (0.1591243309577306, 0.06582188),
        (0.1592036145925522, 0.06243923),
        (0.1361430809100469, 0.05680228),
        (0.1471788781483968, 0.05662742),
        (0.11415033390124638, 0.05296525),
        (0.12003894152243932, 0.05125059),
        (0.11402128958702085, 0.05001825),
        (0.11894379897912341, 0.04899074),
        (0.1281035548051198, 0.04813332),
        (0.13525243226687111, 0.04773366),
        (0.14460051910082494, 0.04762655),
        (0.13943956617514291, 0.04642669),
        (0.15978212849299112, 0.04685014),
        (0.16248728835582732, 0.0463633)
    ])

    n_16_l_3 = Result(16, 3, n_16_l_3_simple, n_16_l_3_metric, n_16_l_3_true, "tab:blue")
    n_64_l_3 = Result(64, 3, n_64_l_3_simple, n_64_l_3_metric, n_64_l_3_true, "tab:orange")
    n_256_l_3 = Result(256, 3, n_256_l_3_simple, n_256_l_3_metric, n_256_l_3_true, "tab:green")
    n_16_l_5 = Result(16, 5, n_16_l_5_simple, n_16_l_5_metric, n_16_l_5_true, "tab:red")
    n_64_l_5 = Result(64, 5, n_64_l_5_simple, n_64_l_5_metric, n_64_l_5_true, "tab:purple")
    n_256_l_5 = Result(256, 5, n_256_l_5_simple, n_256_l_5_metric, n_256_l_5_true, "tab:olive")

    return n_16_l_3, n_64_l_3, n_256_l_3, n_16_l_5, n_64_l_5, n_256_l_5

fig, axs = plt.subplots(1, 1)
results = list(setup())
print(results)

training_epochs = jnp.linspace(1000, 30000, 30)

#axs.set_title("Angle generalisation under simple metric")
#axs.set_title("Radii generalisation under simple metric")
#axs.set_title("Combined generalisation under simple metric")

#axs.set_title("Angle generalisation under modelling metric")
#axs.set_title("Radii generalisation under modelling metric")
#axs.set_title("Combined generalisation under modelling metric")

axs.set_title("Angle generalisation under true metric")
#axs.set_title("Radii generalisation under true metric")
#axs.set_title("Combined generalisation under true metric")

for result in results:
    #axs.plot(training_epochs, result.simple_angle_dist(), label=result.name(), color = result.color, marker='x')
    #axs.plot(training_epochs, result.simple_radii_dist(), label=result.name(), color = result.color, marker='x')
    #axs.plot(training_epochs, result.simple_dist(), label=result.name(), color = result.color, marker='x')
    
    #axs.plot(training_epochs, result.metric_angle_dist(), label=result.name(), color = result.color, marker='x')
    #axs.plot(training_epochs, result.metric_radii_dist(), label=result.name(), color = result.color, marker='x')
    #axs.plot(training_epochs, result.metric_dist(), label=result.name(), color = result.color, marker='x')
    
    axs.plot(training_epochs, result.true_angle_dist(), label=result.name(), color = result.color, marker='x')
    #axs.plot(training_epochs, result.true_radii_dist(), label=result.name(), color = result.color, marker='x')
    #axs.plot(training_epochs, result.true_dist(), label=result.name(), color = result.color, marker='x')
    
#axs.legend(loc='upper right')
#plt.show()
axs.set_xlabel("Score network training epoch")
fig.savefig(
    "results/circle-generalisation-true-angle",
    facecolor=fig.get_facecolor(), edgecolor='none')